# Vulnerability Management Preparation Checklist


# About
This document outlines the steps required to prepare for and establish a vulnerability management program. It does not cover methods for vulnerability discovery (e.g., scanning, pentesting, bug bounty, threat modeling, etc.); instead, it focuses solely on the management, classification, and oversight of identified vulnerabilities. For simplicity, we assume Jira is the bug tracking system in use due to its popularity.


# Preparation steps
- [ ] <b>Identify contractual, compliance, and regulatory requirements:</b>  It is advisable to first consult with your compliance and legal teams to gather requirements from regulatory, contractual, and compliance standard perspectives and incorporate them into your program. Different compliance standards and customer contracts often have strict requirements for remediation timelines, which provide a minimal indication of risk ranking requirements and remediation deadlines.
- [ ] <b>Identify and develop a vulnerability ranking methodology and corresponding Service Level Agreements (SLAs)</b>:  Understanding how your program classifies risk levels and remediation timelines is critical. After gathering requirements from key stakeholders, refer to the <a href="./Vulnerability_management_definitions.md">Vulnerability level definitions</a> for insights into selecting your risk prioritization methodology and reviewing sample SLAs.
- [ ] <b>Identify bug tracking system</b>: Determine which system (e.g., Jira) is used by the majority of engineering to track defects. This bug tracker should be used to file vulnerability tickets. It is not advised to request ops/engineering to use a different system for vulnerability tickets, as this deviates from their workflows and they are less likely to want to work with you.<br>
- [ ] <b>Understand how engineering queues are utilized</b>:  It is essential to understand how the core teams utilize bug tracking and issue management. Your vulnerability management program should seamlessly fit into engineering/ops workflows to streamline the process and reduce friction. <br>
- [ ] <b>Understand how engineering dashboards are used</b>: Most dashboards use precise queries to ensure only the most important issues are visible. Understanding how engineering teams utilize dashboards provides insights into possible queries or query extensions you could develop and offer to ensure security issues appear on their dashboards.<br>
- [ ] <b>Decide how to file vulnerability tickets</b>: Two common approaches are to
     * <b>Option 1 - Create a new issuetype</b>:  Jira supports the concept of issuetypes or sub-ticket types. Creating a custom issuetype for vulnerability ticketing enables full control of the fields and workflows.<br>
<b>Pros</b>: Although it can be difficult to set up initially, it will pay dividends by enabling stable automation, reporting, and dashboarding.<br>
   <b>Cons</b>: It will require working with engineering leaders to ensure these issuetypes appear in their dashboards and queues; otherwise, they may be invisible.<br>
     * <b>Option 2 - Create a security checkbox:</b> This involves creating and placing a checkbox on all ticket types labeled 'Is this a security concern?'<br>
      <b>Pros</b>: An advantage of this approach is that you can easily add a checkbox to all tickets that anyone can select. People outside of security, who aren't familiar with how to reach out to the team, may check this box, providing visibility into issues you'd typically never hear about. <br>
      <b>Cons</b>: Each ticket type will have different fields, making consistent querying for SLAs/remediation timelines difficult, building stable automation impossible, and dashboarding difficult or impossible. Â <bR>
       <br>
       <b>Note:</b> We advise using the issuetype approach; however, this requires more involvement to set up and may not be possible based on your available resources. If resources are very tight, you could start with a checkbox approach and migrate later.
- [ ] <b>Collaborate with key stakeholders to verify the workflow</b>: Once you have mocked up your desired approach for filing/tracking vulnerabilities, it's important to sanity check this with multiple engineering managers and senior SWEs/SREs. This feedback is critical for adoption, buy-in, and ensuring your assumptions are correct.<br>
- [ ] <b>Create vulnerability ticketing in Jira</b>: After determining if Option 1 or Option 2 is the right choice for you, implement it in Jira. Please see '<a href="./Vulnerability_reporting_requirements.md">Vulnerability reporting requirements</A>' for a list of specific fields to include. 
- [ ] <b>Enable new issuetype in sample project:</b> Before adding a new issuetype company-wide, it is best to add it to a ticket type for testing (e.g., within a SECURITY project).
- [ ] <b>Test your ticketing workflow</b>: After implementing it, test every basic workflow including: <br>
    * Closing and reopening the issue.
    * Moving into a review state, then reverting back to the to-do/queue state.
    * Moving from a fixed state back to a pending fix state. This is because people may implement fixes they believe address the issue, but these fixes may be incomplete and require revisiting.
- [ ] <b>Pilot in 1-2 engineering projects</b>: After testing in a sample project, enable it in a small handful of production Jira project types. This will help identify any lingering bugs, use cases, or gaps in the process and oversight. This also allows you to determine Jira queries that can be used on engineering dashboards or other automation. 
- [ ] <b>Expand deployment company-wide</b>: Decide whether to enable it for every project or only specific projects.
- [ ] <b>Determine reporting requirements and capabilities</b>: After reviewing the <a href="./Vulnerability_reporting_requirements.md">reporting requirements</a> and <a href="./Vulnerability_management_metrics.md">metrics sections</a>, determine what metrics and reporting you want.
- [ ] <b>Generate reports for risk owners</b>: A weekly or biweekly report sent to engineering leaders who have issues to address provides visibility into unaddressed risks. Please see '<a href="./Vulnerability_reporting_requirements.md">vulnerability management reporting requirements</a>' for details.
- [ ] <b>Develop automation to identify issues</b>: You will need automation to ensure things are working smoothly, that tickets have the correct fields, and that they aren't assigned to people who have left the company. Please see the ticket health automation section below for details.


# Vulnerability related automation
This section will focus on two important aspects of vulnerability management, reporting, and oversight of ticket health.  

## Automating vulnerability status reporting
Please see the <a href="./Vulnerability_reporting_requirements.md">vulnerability management reporting requirements</a> for this topic. 

## Ticket health automation
Verifying the quality of your tickets in an automated fashion is critical to ensure that risk is properly assigned to the correct owners, classified at the appropriate level, and not lost in the process. It is recommended to build automation that queries for these common quality issues and notifies the security DRI for VM daily:
* <b>Tickets assigned to 'unassigned':</b> Tickets may be accidentally or intentionally assigned to 'unassigned,' and it's important to ensure these tickets are not lost.<br>
* <b>Tickets assigned to employee who have left the company:</b>  At some point, employees will leave the company, and tickets may remain assigned to them. It's important to flag these tickets promptly and reach out to their former manager to determine who the new owner should be. <br>
* <b>Tickets lacking a due date:</b> For various reasons, this field may become blank. Each ticket should have a clear expected fix-by date for the risk owner to evaluate.<br>
* <b>Tickets which have had their priority downgraded:</b> These tickets should be reviewed by the vulnerability management program owner or their delegate to determine if the decision to lower the severity/priority was appropriate. <br>
* <b>Due dates changed:</b> People may attempt to change due dates to circumvent SLA oversight. It is recommended to mark this field as read-only; however, if you are unable to do so, you should monitor this field and notify the security team when the date is changed.<br>
* <b>Tickets which have had their priority increased:</b> These tickets should be promptly reviewed to determine if an urgent matter, possibly requiring a <a href="https://www.sectemplates.com/incident-response/">security incident</a> response, needs to be addressed. It also provides a signal on tickets which, during the transition to a higher priority, could be automatically considered out of SLA.

### Additional Ticket Health Automations Which May Prove Useful
* <b>Tickets which have transitioned to closed without following the proper workflow: </b> After establishing your vulnerability ticket workflow, you will expect certain ticket states before an issue is closed. Creating automation to monitor tickets that have closed with unusual states can highlight incorrect ticket management by the risk owner or developer, as well as other issues. This will be highly dependent on how you have designed your ticket workflows.
          
Checklist version 1.2 copied from [Sectemplates.com](https://www.sectemplates.com) 2024
